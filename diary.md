# AHC018日記

## 1日目（土）

問題を読んだ。面白い。

AHC003にかなり似ているな。コストを推定しながら最小シュタイナー森（水源を1頂点にまとめればそう考えてよい）を構築する問題。

ただAHC003と違って、事前にボーリング調査をやってしまってよい。ボーリング調査をする際は二分探索をするなり平方分割っぽくやる（100階建てのビルから卵を落とすGoogleの例の問題）なりすれば効率的にできそう。どうせ近くにあるマスのコストはそんなに変わらないので近場いくつか掘ってしまってよい。

ボーリング調査結果からコストを復元するのはどうすればいいだろう。Perlin noiseについて調べてみると、Wavelet関数なるものを格子点上にたくさん作ってそれらを補間してあげているらしい。だけどこれを逆方向に推定できる気がしないな。NN使っていい感じに求められないだろうか。超解像とかimg to imgのネットワークとか。

もしNNで求められるようになれば、仮経路を決める→ボーリング調査→仮経路を決める→ボーリング調査→……の繰り返しで少しずつ精緻化していくのがよい気がする。必ずしも1マスずつ順番に掘り進める必要はない。

NNのタスクを定義する。入出力ともに40x40のグレースケール画像とし、出力側は真のマップをリサイズした画像、入力側は出力側からいくつかの点をサンプリングした画像とする。入力側の欠損値はとりあえずサンプリングされた画像の平均値とする。チャンネルを増やして欠損した・していない情報を付加してもよいが、いったん置いておく。

そういえばパラメータ数は提出可能な範囲に収まっているのだろうか。チャンネル数を無闇に増やさなければ大丈夫だと思ってるけど……。

img to imgということでとりあえずUNetを組んでみる。正直全くノウハウがないので「モザイク除去から学ぶ_最先端のディープラーニング」「Kaggleに挑む深層学習プログラミングの極意」などを読みながら必死にそれっぽいものを作った。python難しすぎ……。パラメータ等はあとでRust移植することを考えず適当。

予測してみる。なんだこれ……思った以上にちゃんと予測できてるぞ……！正直ここまでとは思っていなかったので期待以上。かなりテンションが上がっている。いや本当に凄い……。

チャンネルを増やして欠損した・していない情報を付加した。人間の目で見ても分かるくらいに改善されている。これは凄い。苦労してNNを実装した甲斐があった……。

周波数成分が高いケースと低いケースがあるな。下手するとFFTが使えてしまうかもしれない。[AHCで絶対使わないであろうアルゴリズムリスト](https://twitter.com/terry_u16/status/1626768939094274048)に挙げてたのに……。

信頼区間とかを推定するネットワークがあってもいいかもしれない。メモ。

## 2日目（日）

NNのパラメータ数を減らそうかと思ったけど一旦良いか。パラメータ多すぎかと思ったけど減らすと一応目に見えるレベルで出力が変わるので無駄ではないらしい。とはいえSOTA目指すわけじゃないからあとで実行速度・埋め込み可否と相談かな。

白黒の画像を並べて見比べてたらレントゲン写真を見てるお医者さんの気分になってきた。
