mod acl;
mod common;
mod init_solution;
mod input;
mod map;
mod network;
mod output;

use std::{
    io::{self, BufReader},
    time::Instant,
};

use init_solution::InitSolver;
use ndarray::{stack, Array3, Axis};
use output::{output, DiggingResult};
use proconio::source::line::LineSource;
#[allow(unused_imports)]
use proconio::*;
#[allow(unused_imports)]
use rand::prelude::*;

use crate::{
    input::Input,
    network::{NNModule, UNet},
};

pub trait ChangeMinMax {
    fn change_min(&mut self, v: Self) -> bool;
    fn change_max(&mut self, v: Self) -> bool;
}

impl<T: PartialOrd> ChangeMinMax for T {
    fn change_min(&mut self, v: T) -> bool {
        *self > v && {
            *self = v;
            true
        }
    }

    fn change_max(&mut self, v: T) -> bool {
        *self < v && {
            *self = v;
            true
        }
    }
}

#[allow(unused_macros)]
macro_rules! mat {
    ($e:expr; $d:expr) => { vec![$e; $d] };
    ($e:expr; $d:expr $(; $ds:expr)+) => { vec![mat![$e $(; $ds)*]; $d] };
}

fn main() {
    let net = UNet::new();
    let x0 = Array3::from_shape_vec(
        [1, 40, 40],
        vec![
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.058824, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.015686, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.129412,
            0.098039, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.231373, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.152941,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.125490, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.607843, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.007843, 0.184314, 0.078431, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.239216, 0.184314, 0.184314, 0.415686, 0.235294, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.000000, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.003922, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.000000, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.011765, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.027451, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.035294, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.035294, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.666667, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.007843, 0.003922, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.011765,
            0.184314, 0.050980, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.400000, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.086275, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.000000, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.058824, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.000000, 0.184314, 0.003922, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.188235, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.015686, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.027451, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.517647, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.462745, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.274510, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.090196, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.003922, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.039216, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.156863, 0.184314, 0.184314, 0.031373, 0.184314, 0.184314, 0.184314,
            0.184314, 0.000000, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.196078, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.090196, 0.184314, 0.109804, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.003922, 0.184314,
            0.184314, 0.184314, 0.254902, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.054902, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.098039, 0.184314, 0.109804, 0.184314, 0.184314, 0.011765, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.003922, 0.184314, 0.184314,
            0.184314, 0.184314, 0.207843, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.007843, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.325490, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.035294,
            0.184314, 0.184314, 0.184314, 0.098039, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.078431, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.070588,
            0.184314, 0.184314, 0.007843, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.015686, 0.184314, 0.184314, 0.007843, 0.184314, 0.184314, 0.184314,
            0.023529, 0.184314, 0.184314, 0.015686, 0.184314, 0.184314, 0.184314, 0.070588,
            0.125490, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.007843, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.172549, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.015686, 0.184314, 0.094118, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.031373, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.066667, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.007843, 0.184314, 0.184314, 0.184314, 0.027451, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.094118, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.011765, 0.184314, 0.184314, 0.184314, 0.184314, 0.054902, 0.184314,
            0.035294, 0.184314, 0.184314, 0.007843, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.031373, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.031373, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.019608, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.070588, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.172549, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.031373, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.215686, 0.184314,
            0.325490, 0.184314, 0.223529, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.086275, 0.184314, 0.184314, 0.015686, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.341176,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.101961, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.082353, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.015686, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.168627, 0.184314, 0.184314,
            0.184314, 0.631373, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.827451, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.596078, 0.615686, 0.184314, 0.184314,
            0.184314, 0.917647, 0.184314, 0.184314, 0.925490, 0.184314, 0.184314, 0.788235,
            0.184314, 0.360784, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.200000, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.011765, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.921569,
            0.913725, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.047059, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.964706, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.580392,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.262745, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.945098, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.207843, 0.184314, 0.184314,
            0.184314, 0.184314, 0.498039, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
            0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314, 0.184314,
        ],
    )
    .unwrap();
    let x1 = Array3::from_shape_vec(
        [1, 40, 40],
        vec![
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 1., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
            0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
            0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0., 0., 1.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
            0., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
            1., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
            0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 1., 0., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0.,
            1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0.,
            0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 0., 0., 1., 0., 0., 1., 0., 1.,
            0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
            0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        ],
    )
    .unwrap();
    let x = stack![Axis(0), x0, x1];
    let y = net.apply(&x);

    for y in y.iter() {
        eprintln!("{}", y);
    }

    for row in 0..40 {
        for col in 0..40 {
            eprint!("{},", y[[0, row, col]]);
            //if y[[0, row, col]] >= 0.5 {
            //    eprint!("#")
            //} else {
            //    eprint!(" ");
            //}
        }

        eprintln!();
    }

    return;

    let mut stdin = LineSource::new(BufReader::new(io::stdin()));
    let input = Input::read(&mut stdin);
    let mut solver = InitSolver::new(&input);

    loop {
        let action = solver.get_next_action(&input);
        let result = output(action, "", &mut stdin);

        if let DiggingResult::Completed = result {
            break;
        }

        solver.update(result);
    }

    let elapsed = Instant::now() - input.since;
    eprintln!("{:.3}s", elapsed.as_secs_f64());
}
